<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rangoons Edge Computing Status Monitor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 1.1em;
        }

        .nodes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .node-card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .node-card:hover {
            transform: translateY(-5px);
        }

        .node-header {
            padding: 25px;
            text-align: center;
            border-bottom: 2px solid #f0f0f0;
        }

        .node-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 10px;
        }

        .node-subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .node-status {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 0.9em;
            margin-top: 15px;
        }

        .status-online {
            background: #d4edda;
            color: #155724;
        }

        .status-offline {
            background: #f8d7da;
            color: #721c24;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
        }

        .node-body {
            padding: 25px;
        }

        .node-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .info-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .info-value {
            color: #333;
            font-weight: bold;
            font-size: 1.1em;
        }

        .node-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .action-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            transition: transform 0.3s ease;
        }

        .action-btn:hover {
            transform: scale(1.05);
        }

        .cache-section {
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .cache-section h3 {
            color: #333;
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
        }

        .cache-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .cache-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .cache-title {
            color: #333;
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .cache-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .cache-stat {
            padding: 10px;
            background: white;
            border-radius: 8px;
        }

        .cache-stat-label {
            color: #666;
            font-size: 0.8em;
            margin-bottom: 5px;
        }

        .cache-stat-value {
            color: #333;
            font-weight: bold;
            font-size: 1.1em;
        }

        .performance-section {
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .performance-section h3 {
            color: #333;
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
        }

        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .performance-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
        }

        .performance-title {
            color: #333;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
        }

        .performance-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .metric-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }

        .metric-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .metric-value {
            color: #333;
            font-weight: bold;
            font-size: 1.1em;
        }

        .refresh-btn {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            margin: 20px auto;
            display: block;
            transition: transform 0.3s ease;
        }

        .refresh-btn:hover {
            transform: scale(1.05);
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            color: rgba(255,255,255,0.8);
        }

        @media (max-width: 768px) {
            .nodes-grid {
                grid-template-columns: 1fr;
            }
            
            .node-info {
                grid-template-columns: 1fr;
            }
            
            .cache-grid {
                grid-template-columns: 1fr;
            }
            
            .performance-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Rangoons Edge Computing Status Monitor</h1>
            <p>Real-time monitoring of C++ primary server and mobile edge nodes</p>
            <button class="refresh-btn" onclick="refreshAllStatus()">üîÑ Refresh All Status</button>
        </div>

        <!-- Overall Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>üåê Total Nodes</h3>
                <div class="stat-value" id="total-nodes">3</div>
                <div class="stat-label">Primary + Vivo + Samsung</div>
            </div>
            <div class="stat-card">
                <h3>‚úÖ Online Nodes</h3>
                <div class="stat-value" id="online-nodes">0</div>
                <div class="stat-label">Currently Active</div>
            </div>
            <div class="stat-card">
                <h3>‚ö° Total Cache</h3>
                <div class="stat-value" id="total-cache">0 MB</div>
                <div class="stat-label">Combined Cache Size</div>
            </div>
            <div class="stat-card">
                <h3>üöÄ Response Time</h3>
                <div class="stat-value" id="avg-response">0 ms</div>
                <div class="stat-label">Average Response</div>
            </div>
        </div>

        <!-- Edge Nodes Status -->
        <div class="nodes-grid">
            <!-- Primary C++ Server -->
            <div class="node-card">
                <div class="node-header">
                    <div class="node-title">üñ•Ô∏è Primary C++ Server</div>
                    <div class="node-subtitle">High-Performance C++ Core</div>
                    <div class="node-status" id="primary-status">Checking...</div>
                </div>
                <div class="node-body">
                    <div class="node-info">
                        <div class="info-item">
                            <div class="info-label">IP Address</div>
                            <div class="info-value">localhost:8080</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Type</div>
                            <div class="info-value">C++ Primary</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Database</div>
                            <div class="info-value">PostgreSQL</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Uptime</div>
                            <div class="info-value" id="primary-uptime">-</div>
                        </div>
                    </div>
                    <div class="node-actions">
                        <button class="action-btn" onclick="testNode('primary')">üß™ Test</button>
                        <button class="action-btn" onclick="viewNode('primary')">üëÅÔ∏è View</button>
                    </div>
                </div>
            </div>

            <!-- Vivo Mobile Edge -->
            <div class="node-card">
                <div class="node-header">
                    <div class="node-title">üì± Vivo Mobile Edge</div>
                    <div class="node-subtitle">Mobile Edge Computing Node</div>
                    <div class="node-status" id="vivo-status">Checking...</div>
                </div>
                <div class="node-body">
                    <div class="node-info">
                        <div class="info-item">
                            <div class="info-label">IP Address</div>
                            <div class="info-value">192.168.18.22:8081</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Type</div>
                            <div class="info-value">Vivo Mobile</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Database</div>
                            <div class="info-value">PostgreSQL</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Uptime</div>
                            <div class="info-value" id="vivo-uptime">-</div>
                        </div>
                    </div>
                    <div class="node-actions">
                        <button class="action-btn" onclick="testNode('vivo')">üß™ Test</button>
                        <button class="action-btn" onclick="viewNode('vivo')">üëÅÔ∏è View</button>
                    </div>
                </div>
            </div>

            <!-- Samsung Mobile Edge -->
            <div class="node-card">
                <div class="node-header">
                    <div class="node-title">üì± Samsung Mobile Edge</div>
                    <div class="node-subtitle">Advanced Edge Computing Node</div>
                    <div class="node-status" id="samsung-status">Checking...</div>
                </div>
                <div class="node-body">
                    <div class="node-info">
                        <div class="info-item">
                            <div class="info-label">IP Address</div>
                            <div class="info-value">192.168.18.160:8082</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Type</div>
                            <div class="info-value">Samsung Mobile</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Database</div>
                            <div class="info-value">PostgreSQL</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Uptime</div>
                            <div class="info-value" id="samsung-uptime">-</div>
                        </div>
                    </div>
                    <div class="node-actions">
                        <button class="action-btn" onclick="testNode('samsung')">üß™ Test</button>
                        <button class="action-btn" onclick="viewNode('samsung')">üëÅÔ∏è View</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cache Statistics -->
        <div class="cache-section">
            <h3>üíæ Edge Computing Cache Statistics</h3>
            <div class="cache-grid">
                <div class="cache-card">
                    <div class="cache-title">Primary C++ Cache</div>
                    <div class="cache-stats">
                        <div class="cache-stat">
                            <div class="cache-stat-label">Size</div>
                            <div class="cache-stat-value" id="primary-cache-size">-</div>
                        </div>
                        <div class="cache-stat">
                            <div class="cache-stat-label">Hit Ratio</div>
                            <div class="cache-stat-value" id="primary-cache-hit">-</div>
                        </div>
                    </div>
                </div>
                <div class="cache-card">
                    <div class="cache-title">Vivo Mobile Cache</div>
                    <div class="cache-stats">
                        <div class="cache-stat">
                            <div class="cache-stat-label">Size</div>
                            <div class="cache-stat-value" id="vivo-cache-size">-</div>
                        </div>
                        <div class="cache-stat">
                            <div class="cache-stat-label">Hit Ratio</div>
                            <div class="cache-stat-value" id="vivo-cache-hit">-</div>
                        </div>
                    </div>
                </div>
                <div class="cache-card">
                    <div class="cache-title">Samsung Mobile Cache</div>
                    <div class="cache-stats">
                        <div class="cache-stat">
                            <div class="cache-stat-label">Size</div>
                            <div class="cache-stat-value" id="samsung-cache-size">-</div>
                        </div>
                        <div class="cache-stat">
                            <div class="cache-stat-label">Hit Ratio</div>
                            <div class="cache-stat-value" id="samsung-cache-hit">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance Metrics -->
        <div class="performance-section">
            <h3>‚ö° Performance Metrics</h3>
            <div class="performance-grid">
                <div class="performance-card">
                    <div class="performance-title">Primary C++ Server</div>
                    <div class="performance-metrics">
                        <div class="metric-item">
                            <div class="metric-label">Memory Usage</div>
                            <div class="metric-value" id="primary-memory">-</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">CPU Usage</div>
                            <div class="metric-value" id="primary-cpu">-</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Active Connections</div>
                            <div class="metric-value" id="primary-connections">-</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Response Time</div>
                            <div class="metric-value" id="primary-response">-</div>
                        </div>
                    </div>
                </div>
                <div class="performance-card">
                    <div class="performance-title">Vivo Mobile Edge</div>
                    <div class="performance-metrics">
                        <div class="metric-item">
                            <div class="metric-label">Memory Usage</div>
                            <div class="metric-value" id="vivo-memory">-</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">CPU Usage</div>
                            <div class="metric-value" id="vivo-cpu">-</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Active Connections</div>
                            <div class="metric-value" id="vivo-connections">-</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Response Time</div>
                            <div class="metric-value" id="vivo-response">-</div>
                        </div>
                    </div>
                </div>
                <div class="performance-card">
                    <div class="performance-title">Samsung Mobile Edge</div>
                    <div class="performance-metrics">
                        <div class="metric-item">
                            <div class="metric-label">Memory Usage</div>
                            <div class="metric-value" id="samsung-memory">-</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">CPU Usage</div>
                            <div class="metric-value" id="samsung-cpu">-</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Active Connections</div>
                            <div class="metric-value" id="samsung-connections">-</div>
                        </div>
                        <div class="metric-item">
                            <div class="metric-label">Response Time</div>
                            <div class="metric-value" id="samsung-response">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2024 Rangoons Edge Computing System | Real-time monitoring with C++ performance optimization</p>
        </div>
    </div>

    <script>
        // Node configurations
        const nodes = {
            primary: {
                url: 'http://localhost:8080',
                name: 'Primary C++ Server',
                type: 'cpp'
            },
            vivo: {
                url: 'http://192.168.18.22:8081',
                name: 'Vivo Mobile Edge',
                type: 'vivo'
            },
            samsung: {
                url: 'http://192.168.18.160:8082',
                name: 'Samsung Mobile Edge',
                type: 'samsung'
            }
        };

        // Status update intervals
        let statusInterval;
        let performanceInterval;

        // Initialize monitoring
        document.addEventListener('DOMContentLoaded', function() {
            refreshAllStatus();
            startMonitoring();
        });

        // Start continuous monitoring
        function startMonitoring() {
            // Update status every 10 seconds
            statusInterval = setInterval(refreshAllStatus, 10000);
            
            // Update performance every 30 seconds
            performanceInterval = setInterval(refreshPerformance, 30000);
        }

        // Refresh all node status
        async function refreshAllStatus() {
            console.log('üîÑ Refreshing all node status...');
            
            const promises = Object.keys(nodes).map(async (nodeKey) => {
                await checkNodeStatus(nodeKey);
            });
            
            await Promise.all(promises);
            updateOverallStats();
        }

        // Check individual node status
        async function checkNodeStatus(nodeKey) {
            const node = nodes[nodeKey];
            const startTime = Date.now();
            
            try {
                const response = await fetch(`${node.url}/health`, {
                    method: 'GET',
                    timeout: 5000
                });
                
                if (response.ok) {
                    const data = await response.json();
                    const responseTime = Date.now() - startTime;
                    
                    updateNodeStatus(nodeKey, 'online', data, responseTime);
                } else {
                    updateNodeStatus(nodeKey, 'offline', null, 0);
                }
            } catch (error) {
                console.error(`‚ùå Error checking ${nodeKey} status:`, error);
                updateNodeStatus(nodeKey, 'offline', null, 0);
            }
        }

        // Update node status display
        function updateNodeStatus(nodeKey, status, data, responseTime) {
            const statusElement = document.getElementById(`${nodeKey}-status`);
            const uptimeElement = document.getElementById(`${nodeKey}-uptime`);
            
            // Update status indicator
            statusElement.className = `node-status status-${status}`;
            statusElement.textContent = status === 'online' ? 'üü¢ ONLINE' : 'üî¥ OFFLINE';
            
            // Update uptime
            if (status === 'online' && data) {
                const uptimeMinutes = Math.round(data.uptime / 60);
                uptimeElement.textContent = `${uptimeMinutes} min`;
                
                // Update response time
                const responseElement = document.getElementById(`${nodeKey}-response`);
                if (responseElement) {
                    responseElement.textContent = `${responseTime} ms`;
                }
            } else {
                uptimeElement.textContent = '-';
                const responseElement = document.getElementById(`${nodeKey}-response`);
                if (responseElement) {
                    responseElement.textContent = '-';
                }
            }
        }

        // Refresh performance metrics
        async function refreshPerformance() {
            console.log('‚ö° Refreshing performance metrics...');
            
            const promises = Object.keys(nodes).map(async (nodeKey) => {
                await updateNodePerformance(nodeKey);
            });
            
            await Promise.all(promises);
        }

        // Update node performance metrics
        async function updateNodePerformance(nodeKey) {
            const node = nodes[nodeKey];
            
            try {
                let performanceUrl;
                if (nodeKey === 'primary') {
                    performanceUrl = `${node.url}/status`;
                } else {
                    performanceUrl = `${node.url}/api/edge/performance`;
                }
                
                const response = await fetch(performanceUrl);
                if (response.ok) {
                    const data = await response.json();
                    updatePerformanceDisplay(nodeKey, data);
                }
            } catch (error) {
                console.error(`‚ùå Error updating ${nodeKey} performance:`, error);
            }
        }

        // Update performance display
        function updatePerformanceDisplay(nodeKey, data) {
            // Update memory usage
            const memoryElement = document.getElementById(`${nodeKey}-memory`);
            if (memoryElement && data.memory) {
                const memoryMB = Math.round(data.memory.heapUsed / 1024 / 1024);
                memoryElement.textContent = `${memoryMB} MB`;
            }
            
            // Update CPU usage (if available)
            const cpuElement = document.getElementById(`${nodeKey}-cpu`);
            if (cpuElement && data.cpu) {
                cpuElement.textContent = 'Active';
            }
            
            // Update active connections
            const connectionsElement = document.getElementById(`${nodeKey}-connections`);
            if (connectionsElement && data.database) {
                connectionsElement.textContent = data.database.poolSize || 0;
            }
            
            // Update cache statistics
            if (data.cache) {
                updateCacheDisplay(nodeKey, data.cache);
            }
        }

        // Update cache display
        function updateCacheDisplay(nodeKey, cacheData) {
            const sizeElement = document.getElementById(`${nodeKey}-cache-size`);
            const hitElement = document.getElementById(`${nodeKey}-cache-hit`);
            
            if (sizeElement) {
                const sizeMB = Math.round(cacheData.cacheSize / 1024 / 1024);
                sizeElement.textContent = `${sizeMB} MB`;
            }
            
            if (hitElement) {
                const hitRatio = Math.round(cacheData.hitRatio * 100);
                hitElement.textContent = `${hitRatio}%`;
            }
        }

        // Update overall statistics
        function updateOverallStats() {
            let onlineCount = 0;
            let totalCache = 0;
            let totalResponse = 0;
            let responseCount = 0;
            
            Object.keys(nodes).forEach(nodeKey => {
                const statusElement = document.getElementById(`${nodeKey}-status`);
                if (statusElement.textContent.includes('ONLINE')) {
                    onlineCount++;
                }
                
                const responseElement = document.getElementById(`${nodeKey}-response`);
                if (responseElement && responseElement.textContent !== '-') {
                    const responseTime = parseInt(responseElement.textContent);
                    if (!isNaN(responseTime)) {
                        totalResponse += responseTime;
                        responseCount++;
                    }
                }
                
                const cacheSizeElement = document.getElementById(`${nodeKey}-cache-size`);
                if (cacheSizeElement && cacheSizeElement.textContent !== '-') {
                    const sizeMB = parseInt(cacheSizeElement.textContent);
                    if (!isNaN(sizeMB)) {
                        totalCache += sizeMB;
                    }
                }
            });
            
            // Update display
            document.getElementById('online-nodes').textContent = onlineCount;
            document.getElementById('total-cache').textContent = `${totalCache} MB`;
            
            if (responseCount > 0) {
                const avgResponse = Math.round(totalResponse / responseCount);
                document.getElementById('avg-response').textContent = `${avgResponse} ms`;
            }
        }

        // Test individual node
        function testNode(nodeKey) {
            console.log(`üß™ Testing ${nodeKey} node...`);
            checkNodeStatus(nodeKey);
        }

        // View node details
        function viewNode(nodeKey) {
            const node = nodes[nodeKey];
            window.open(`${node.url}/health`, '_blank');
        }

        // Manual refresh
        function refreshAllStatus() {
            console.log('üîÑ Manual refresh requested...');
            refreshAllStatus();
        }

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (statusInterval) clearInterval(statusInterval);
            if (performanceInterval) clearInterval(performanceInterval);
        });
    </script>
</body>
</html>
